
\subsection{Geometric Realization}

We wish to use expression graphs to generate linear maps by viewing the edges as
paths in a manifold equipped with an algebra-fibred bundle with connection,
taking their associated parallel transport maps, and combining these maps in a
pattern encoded in the expression graph. To accomplish this, we use the
following simple notion of geometric realization of graphs.

\begin{defn}[Geometric Graph]
A graph in a manifold $M$ or a geometric graph is a graph $G = (V, E)$ equipped
with a function $\gamma : E \to C^0(I, M)$, called a geometric realization of
$G$. We call $M$ the realizing manifold of $G$ under $\gamma$. For an edge from
$u$ to $v$ we write $\gamma_{u, v}$ to denote the path associated to that edge.
\end{defn}

\begin{rmk}
A geometric graph is essentially a collection of paths in a manifold but we
consider one or more copies of each path and ``identify'' their end-points in a
pattern encoded by a graph, even though these paths need not share end-points --
that is, we do not strictly require $\gamma_{u, v}(1) = \gamma_{v, w}(0)$. We
will see that this relaxation is essential to defining our notion of TQFTs. We
will ultimately be interested in expression graphs in manifolds, which will
provide us with a way to associate linear maps to manifolds.
\end{rmk}

\begin{exm}\label{exm:geomegraph}
Consider the graph in example \ref{exm:egraph1}. Then, we consider a mapping of
the edges to paths on a surface as shown below.\footnote{This diagram was
generated using \cite{Mathcha}.} Note that here we have
$\gamma_{u, v}(1) = \gamma_{v, w}(0)$ for most points but not all -- for
instance, $\gamma_{2, 3}$ and $\gamma_{3, 5}$ do not share any end-points.
\begin{figure}[H]
\begin{center}
\input{\PRJWD/graphs/path_graph_diag_1}
\end{center}
\caption{A geometric graph}
\end{figure}
We notice that the same algebraic expression carries over:
\begin{align*}
        & (\gamma_{5, 8} \tensor (\gamma_{6, 9} \cwedge \gamma_{7, 9})) \\
  \circ & (\gamma_{3, 5} \tensor \gamma_{3, 6} \tensor \gamma_{4, 7}) \\
  \circ & ((\gamma_{3, 3} \cvee \gamma_{3, 3}) \tensor \gamma_{4, 4}) \\
  \circ & (\gamma_{3, 3} \tensor (\gamma_{4, 4} \boxtimes \gamma_{2, 3})) \\
  \circ & ((\gamma_{1, 3} \cvee \gamma_{1, 4}) \tensor \gamma_{2, 2})
\end{align*}
\end{exm}

At this point, we make a necessary observation. Consider geometric expression
graphs in a manifold equipped with an $A$--fibred bundle with connection. Then,
consider the expression of an expression graph realized in this manifold. If we
substitute the edges in the expression of the graph with the parallel transport
maps along the paths associated to the edges, we obtain a linear map from a
non-zero tensor power of $A$ to another such tensor power, given the graph has
at least one edge. However, there is no immediate way to obtain a map of the
form $\R \to A$ or $A \to \R$ in this method.

We recall that cobordisms $\varnothing \to S^1$ or
$S^1 \to \varnothing$ in $\Cob_2$ are given by composing cobordisms
$S^1 \to S^1$ with the following structures:
\[\begin{tikzpicture}[scale=0.5]
\cupcob{0, 2}
\node at (1.5, 0) (cuplbl) {{\footnotesize cup}};
\end{tikzpicture}
\qquad \qquad \qquad
\begin{tikzpicture}[scale=0.5]
\capcob{3, 2}
\node at (1.5, 0) (caplbl) {{\footnotesize cap}};
\end{tikzpicture}\]
We would like analogous structures for expression graphs. We can use vertex
colouring to distinguish between copies of the empty manifold and copies of
$S^1$ in the result of the expression construction. So, we consider vertex
coloured expression graphs.
%Visually, loops
%attached to the source or target of an edge seem like possible candidates for
%these structures:
%\[\begin{tikzpicture}
%\node[circle, fill, inner sep=1.5pt] at (0, 0) (a) {};
%\node[circle, fill, inner sep=1.5pt] at (1, 0) (b) {};
%\draw[->] (a) [out=130, in=230, looseness=25] to (a);
%\midarrow{a}{b}
%\end{tikzpicture}
%\qquad \qquad \qquad
%\begin{tikzpicture}
%\node[circle, fill, inner sep=1.5pt] at (0, 0) (a) {};
%\node[circle, fill, inner sep=1.5pt] at (1, 0) (b) {};
%\draw[->] (b) [out=50, in=-50, looseness=25] to (b);
%\midarrow{a}{b}
%\end{tikzpicture}\]
%We will show that if we allow loops on vertices except for the ones which do not
%have any incoming or outgoing edges to begin with, then we can adapt the
%theory to this new setting.

%As a start, the expression construction algorithm is extended as follows:
%\begin{alg}
%Let $G$ be a graph where vertices, except for those without any edges from or to
%other vertices, can have loops. We then make the following modifications to $G$:
%\begin{enumerate}[(1)]
%\setlength{\itemsep}{0pt}
%
%\item Colour every vertex with a single colour -- say blue.
%
%\item If $u$ has no incoming edges except for a loop $(u, u)$ but has outgoing
%edges, then we add another copy $u'$ of $u$, color it green, add the edge
%$(u', u)$ and delete the loop $(u, u)$.
%\[\begin{tikzpicture}
%\node[circle, fill, inner sep=1.5pt, color=blue] at (0, 0) (a) {};
%\node[circle, fill, inner sep=1.5pt, color=blue] at (1, 0.5) (b1) {};
%\node[circle, fill, inner sep=1.5pt, color=blue] at (1, -0.5) (bn) {};
%\midarrow{a}{b1}
%\midarrow{a}{bn}
%\draw[->] (a) [out=130, in=230, looseness=15] to (a);
%\draw[loosely dotted, thick] (b1) -- (bn);
%\end{tikzpicture}
%\qquad
%\begin{tikzpicture}
%\node at (0, 0.5)   (TOP)     {};
%\node at (0, 0)   (TO)      {$\Longrightarrow$};
%\node at (0, -0.5)  (BOTTOM)  {};
%\end{tikzpicture}
%\qquad
%\begin{tikzpicture}
%\node[circle, fill, inner sep=1.5pt, color=green!55!black] at (0, 0) (a1) {};
%\node[circle, fill, inner sep=1.5pt, color=blue] at (1, 0) (a2) {};
%\node[circle, fill, inner sep=1.5pt, color=blue] at (2, 0.5) (b1) {};
%\node[circle, fill, inner sep=1.5pt, color=blue] at (2, -0.5) (bn) {};
%\midarrow{a1}{a2}
%\midarrow{a2}{b1}
%\midarrow{a2}{bn}
%\draw[loosely dotted, thick] (b1) -- (bn);
%\end{tikzpicture}\]
%
%\item If $u$ has incoming edges but no outgoing edges except for a loop
%$(u, u)$, then we add a green copy $u'$ of $u$ as before, add the edge $(u, u')$
%and delete the loop $(u, u)$.
%\[\begin{tikzpicture}
%\node[circle, fill, inner sep=1.5pt, color=blue] at (0, 0) (a) {};
%\node[circle, fill, inner sep=1.5pt, color=blue] at (-1, 0.5) (b1) {};
%\node[circle, fill, inner sep=1.5pt, color=blue] at (-1, -0.5) (bn) {};
%\midarrow{b1}{a}
%\midarrow{bn}{a}
%\draw[->] (a) [out=50, in=-50, looseness=15] to (a);
%\draw[loosely dotted, thick] (b1) -- (bn);
%\end{tikzpicture}
%\qquad
%\begin{tikzpicture}
%\node at (0, 0.5)   (TOP)     {};
%\node at (0, 0)   (TO)      {$\Longrightarrow$};
%\node at (0, -0.5)  (BOTTOM)  {};
%\end{tikzpicture}
%\qquad
%\begin{tikzpicture}
%\node[circle, fill, inner sep=1.5pt, color=green!55!black] at (0, 0) (a1) {};
%\node[circle, fill, inner sep=1.5pt, color=blue] at (-1, 0) (a2) {};
%\node[circle, fill, inner sep=1.5pt, color=blue] at (-2, 0.5) (b1) {};
%\node[circle, fill, inner sep=1.5pt, color=blue] at (-2, -0.5) (bn) {};
%\midarrow{a2}{a1}
%\midarrow{b1}{a2}
%\midarrow{bn}{a2}
%\draw[loosely dotted, thick] (b1) -- (bn);
%\end{tikzpicture}\]
%
%\item If $u$ has both incoming and outgoing edges along with a loop $(u, u)$,
%we replace the loop with a path $u, u', u''$, where $u'$ is a green copy of $u$
%and $u''$ is another blue copy of $u$.
%\[\begin{tikzpicture}
%\node[circle, fill, inner sep=1.5pt, color=blue] at (0, 0) (a) {};
%\node[circle, fill, inner sep=1.5pt, color=blue] at (1, 0.35) (b1) {};
%\node[circle, fill, inner sep=1.5pt, color=blue] at (1, -0.35) (bn) {};
%\node[circle, fill, inner sep=1.5pt, color=blue] at (-1, 0.35) (c1) {};
%\node[circle, fill, inner sep=1.5pt, color=blue] at (-1, -0.35) (cn) {};
%\midarrow{a}{b1}
%\midarrow{a}{bn}
%\draw[->] (a) [out=60, in=120, looseness=15] to (a);
%\midarrow{c1}{a}
%\midarrow{cn}{a}
%\draw[loosely dotted, thick] (b1) -- (bn);
%\draw[loosely dotted, thick] (c1) -- (cn);
%\end{tikzpicture}
%\qquad
%\begin{tikzpicture}
%\node at (0, 0.35)   (TOP)     {};
%\node at (0, 0)   (TO)      {$\Longrightarrow$};
%\node at (0, -0.35)  (BOTTOM)  {};
%\end{tikzpicture}
%\qquad
%\begin{tikzpicture}
%\node[circle, fill, inner sep=1.5pt, color=blue] at (-1, 0) (a1) {};
%\node[circle, fill, inner sep=1.5pt, color=green!55!black] at (0, 0) (a2) {};
%\node[circle, fill, inner sep=1.5pt, color=blue] at (1, 0) (a3) {};
%\node[circle, fill, inner sep=1.5pt, color=blue] at (2, 0.35) (b1) {};
%\node[circle, fill, inner sep=1.5pt, color=blue] at (2, -0.35) (bn) {};
%\node[circle, fill, inner sep=1.5pt, color=blue] at (-2, 0.35) (c1) {};
%\node[circle, fill, inner sep=1.5pt, color=blue] at (-2, -0.35) (cn) {};
%\midarrow{a3}{b1}
%\midarrow{a3}{bn}
%\midarrow{c1}{a1}
%\midarrow{cn}{a1}
%\midarrow{a1}{a2}
%\midarrow{a2}{a3}
%\draw[loosely dotted, thick] (b1) -- (bn);
%\draw[loosely dotted, thick] (c1) -- (cn);
%\end{tikzpicture}\]
%
%\item If $G$ is a disjoint union $\coprod_i G_i$ and some $G_i = \varnothing$,
%we replace $G_i$ with an edge $(u_{G_i}, v_{G_i})$, where both the vertices are
%green:
%\[\begin{tikzpicture}
%\node at (0, 0) (a) {$\varnothing$};
%\end{tikzpicture}
%\qquad
%\begin{tikzpicture}
%\node at (0, 0)   (TO)      {$\Longrightarrow$};
%\end{tikzpicture}
%\qquad
%\begin{tikzpicture}
%\node[circle, fill, inner sep=1.5pt, color=green!55!black] at (0, 0) (a1) {};
%\node[circle, fill, inner sep=1.5pt, color=green!55!black] at (2, 0) (a3) {};
%\midarrow{a1}{a3}
%\end{tikzpicture}\]
%\begin{rmk}
%This is a case we ignored in the first expression construction aglorithm -- we
%did so for simplicity. We handle this now because we now have a way to deal with
%empty sources and targets.
%\end{rmk}
%
%\item We apply the steps of the first expression construction algorithm with
%copied vertices having the same colour as the original.
%
%\item We then identify green vertices with the empty manifold and obtain our
%expression from the identification of the graph in its final state with some
%cobordism in $\Cob_2$.
%
%\end{enumerate}
%\end{alg}

%Disjoint unions are easily adapted as well. However, we will change our
%definitions of source and target expression graphs since we will now interpret
%looped vertices as cobordisms of the empty manifold. We first adapt expression
%graphs to include loops.

\begin{defn}[Pretransport Graph]
A pretransport graph is an expression graph $G$ with a colour function
$V(G) \to \set{{\color{green!55!black}\text{green}},
{\color{blue!55!black}\text{blue}}}$ (with no constraints on adjacency of
vertices).
\end{defn}

\begin{defn}[Pretransport Homomorphism]
A pretransport homomorphism is a colour-preserving expression homomorphism.
\end{defn}

%\begin{rmk}
%We note that pretransport homomorphisms, being graph homomorphisms must preserve
%loops.
%\end{rmk}

From \ref{cor:expiso_unique}, it is immediate that:

\begin{cor}
Pretransport isomorphisms are unique.
\end{cor}

We now redefine the source and target of a pretransport graph so that
constructions like expressions and gluing can be adapted to this new setting
where we allow empty graphs to be sources and targets.

\begin{defn}
Let $G$ be a pretransport graph with $s_1, \dots, s_n$ the ordering of the
source vertices of its underlying expression graph and $t_1, \dots, t_m$ the
ordering of the target vertices thereof. Let $s_{i_1}, \dots, s_{i_p}$ be the
green source vertices and $t_{j_1}, \dots t_{j_q}$ be the green target vertices
in $G$. Then, the source of $G$ is defined to be the expression graph
\[
  S(G) := \set{s_1, \dots, s_{i_1 - 1}}
       \amalg \varnothing
       \amalg \set{s_{i_1 + 1}, \dots, s_{i_2}}
       \amalg \varnothing
       \amalg \cdots
       \amalg \varnothing
       \amalg \set{s_{i_p + 1}, \dots, s_{n}}
\]
The target of $G$ is defined to be the expression graph
\[
  T(G) := \set{t_{1}, \dots, t_{j_1 - 1}}
       \amalg \varnothing
       \amalg \set{t_{j_1 + 1}, \dots, t_{j_2}}
       \amalg \varnothing
       \amalg \cdots
       \amalg \varnothing
       \amalg \set{t_{j_q + 1}, \dots, t_{m}}
\]
\end{defn}

\begin{defn}
Gluing of expression graphs extends to gluing of pretransport graphs if we
consider pretransport isomorphisms instead of expression isomorphisms. More
precisely, for pretransport graphs $G$ and $H$, if $S(H) \cong T(G)$, then the
gluing is exactly the same as for expression graphs except for positions where
we have instances of $\varnothing$. For this, we have the following cases:
\begin{enmrt}
\li $H$ and $G$ both have green vertices at that position: we glue them
as usual.
\li $H$ has a green vertex but $G$ has $\varnothing$: we simply forget
that $G$ has $\varnothing$.
\li $H$ has $\varnothing$ but $G$ has a green vertex: we forget the copy
of $\varnothing$
\li $H$ and $G$ both have copies of $\varnothing$: we keep a single copy
of $\varnothing$
\end{enmrt}
\end{defn}

\begin{defn}[Expression Construction]
The expression of a pretransport graph $G$ is obtained by running the expression
construction on $G$ by forgetting colours and then identifying green vertices
with the empty manifold in the resulting cobordism in $\Cob_2$.
\end{defn}

We then consider the class of graphs that will yield our desired linear maps.

\begin{defn}[Transport Graph]
We call a geometric pretransport graph a transport graph.
\end{defn}

\begin{defn}[Geometric Homomorphism]
Let $G$ and $H$ be graphs in manifolds $M$ and $N$ with geometric realizations
$\gamma^G$ and $\gamma^H$ respectively, then a homomorphism $h : G \to H$
equipped with a smooth map $f : M \to N$ making the following diagram commute is
called a geometric homomorphism:
\[\begin{tikzpicture}[baseline=(a).base]
\node[scale=\diagscale] (a) at (0, 0){
\begin{tikzcd}
E(G) \ar[d, "\gamma^G" left] \ar[r, "h" above] &
E(H) \ar[d, "\gamma^H" right] \\
C^0(I, M) \ar[r, "f_*" below] &
C^0(I, N)
\end{tikzcd}
};
\end{tikzpicture}\]
where $f_*$ is the post-composition map $g \mapsto f \circ g$, and the
homomorphism $h$ is viewed as the function it induces on edge sets.
\end{defn}

\begin{defn}[Transport Homomorphism]
A geometric pretransport homomorphism is called a transport homomorphism.
\end{defn}

Pasting commutative squares as the one above along the $\gamma$ sides, we
observe that geometric homomorphisms compose associatively. Taking
$h$ and $f$ as the identity maps yields an identity morphism of geometric
graphs. Similarly, transport homomorphism also compose associatively and have
units. Furthermore, transport graphs inherit the disjoint union from their
underlying expression graphs and manifolds. For their gluing, we require a
notion of gluing geometric realizations.

We first observe that if $G$ and $H$ are transport graphs with a transport
isomorphism $S(H) \to T(G)$, it is unique by \ref{cor:expiso_unique}, since
there is only one map of path sets -- the empty map which always makes the
rquired diagram commute. We then have the following basic fact.

\begin{cor}
Let $G$ and $H$ be transport graphs realized in manifolds
$M$ and $N$ with geometric realizations $\gamma^G$ and
$\gamma^H$ respectively such that $\psi_{G, H} : S(H) \to T(G)$ is a unique
pretransport homomorphism, and $M$ and $N$ are ``smoothly gluable'' at some
part. Then, there exists a geometric realization
\[
  \gamma^H * \gamma^G : E(H * G) \to C^0(I, N * M)
\]
of the pretransport graph $H * G$ in $N * M$.
\end{cor}
\begin{proof}
We can define $\gamma^H * \gamma^G$ piecewise since the gluing site has no
edges.
\end{proof}

\begin{defn}[Gluing Transport Graphs]
For transport graphs $(G, \gamma^G)$ and $(H, \gamma^H)$ with $S(H) \cong T(G)$
with a transport homomorphism, we define their gluing in the obvious way:
\[
  (H, \gamma^H) * (G, \gamma^G) := (H * G, \gamma^H * \gamma^G)
\]
\end{defn}

This is enough structure to develop a simple system for doing algebra using
paths on a manifold. In particular, it yields at least two monoidal double
categories of transport graphs realized in manifolds. We develop one of these
notions of TQFTs next.
\TODO{I am not sure if it is appropriate call this a notion of TQFTs.}

